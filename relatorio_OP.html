<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Ordem de Produção</title>

<style>
@page {
    size: A4;
    margin: 20mm;
}

body {
    font-family: Arial, Helvetica, sans-serif;
    margin: 0;
    padding: 0;
    color: #000;
}

/* TÍTULO */
.titulo {
    text-align: center;
    font-size: 32px;
    font-weight: bold;
    letter-spacing: 2px;
    margin-bottom: 40px;
}

/* BLOCO INFORMAÇÕES */
.info-container {
    width: 100%;
}

.linha {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    font-size: 14px;
}

.coluna {
    width: 32%;
}

.label {
    font-weight: bold;
}

.valor {
    font-weight: normal;
}

</style>
</head>

<body>

<div class="titulo">
    ORDEM DE PRODUÇÃO
</div>

<div class="info-container">

    <div class="linha">
        <div class="coluna">
            <span class="label">Ordem Nº:</span>
            <span class="valor" id="ordem"></span>
        </div>

        <div class="coluna" style="text-align:center;">
            <span class="label">Status OP:</span>
            <span class="valor" id="status"></span>
        </div>

        <div class="coluna" style="text-align:right;">
            <span class="label">Data:</span>
            <span class="valor" id="data"></span>
        </div>
    </div>

</div>

<script>
function getParametro(nome) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(nome);
}

// Pega JSON da URL
let dadosParam = getParametro("dados");

if (dadosParam) {
    let dados = JSON.parse(decodeURIComponent(dadosParam));

    // Como vem de collection, pega o primeiro registro
    let registro = dados[0];

    document.getElementById("ordem").textContent = registro.Ordem || "";
    document.getElementById("status").textContent = registro.Status || "";
    document.getElementById("data").textContent = registro.Data || "";
}
</script>

</body>
</html>
